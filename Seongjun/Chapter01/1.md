## 1.1 모놀리식 지옥

FTGO 애플리케이션

* 소비자가 웹 / 앱에 접속해서 인근 음식점에 주문하면 배달해주는거
* 배달원과 음식점에 대금을 지불해줌
* 음식점은 메뉴를 편집하고 주문을 관리함
* 대금 지블은 스프라이트 메시지 전송은 트윌리오 이메일은 SES를 씀
* WAR파일로 구성된 모놀리스로 개발됨
* 스파게티코드범벅 느려지고....

## 1. FTGO의 아키택쳐

* 육각형 아키텍쳐이다. 
* UI구현 및 외부 시스템 통합을 담당하는 다양한 어뎁터가 비지니스 로직을 감쌈

![image](https://user-images.githubusercontent.com/72075148/134780533-69a8886c-2dbc-4d1d-bf2a-a77a1065ea41.png)

* 논리적으로 모듈화 했지만 WAR 파일 하나로 패키징한다.
* 마치 실행파일 하나, 단일 소스코드 디렉토리 체계로 배포하는 것과 같음

## 2. 모놀리식 아키텍처 장점

* 개발이 간단하다.
* 쉽게 변경 가능 - 빌드/배포 용이
* 테스트가 쉽다
* 배포가 쉽다. - 그냥 복붙하나
* 확장하기 쉽다.. - lb 뒤에 인스턴스 여러개

## 3. 실상

* 시간이 지나면서 거대한 코드가 됨
* 너무 복잡해서 버그 고치기 힘들고 이해가 어려움
* 개발이 더딤
* 커밋부터 배포까지 험난한 여정..? 
* 화갖ㅇ이 어렵다.
* 테스트도 어렵다..등
* 한물간 기술 스택에 발목이 잡힌다.
* 뭐 대충 어렵다는 얘끼

### 1.2 이 책의 대상 독자...

### 1.3 학습 내용..

# 1.4 마이크로서비스 아키텍쳐가 답

* 아키텍쳐는 기능 요건과 무관하게 다 구현 가능함 사실, 하지만 서비스 품질 요건에 영향을 미친다

## 1. 확장 큐브와 마이크로서비스

![image](https://user-images.githubusercontent.com/72075148/134808138-9ba90b75-f1f5-40fc-a359-eae331b4ec24.png)

### X축 확장 - 다중 인스턴스에 분산

* 모놀리식 애플리케이션의 확장 수단
* 로드밸런서 뒤에 인스턴스 N개 띄워 놓고, 분배..

### Z축 확장 - 요청 속성 별 라우팅

* 라우터는 요청 속성에 알맞은 인스턴스로 라우팅 한다 - userId에 따라 ? 이런식
* 인스턴스는 자기에게 배정된 하위 집합만 처리한다.
* 헤더에 포함된 userId를 보고 N개의 동일한 애플리케이션 인스턴스 중 하나를 선택
* 증가하는 트랜잭션 및 데이터 볼륨을 처리하기 좋은 수단

### Y축 확장 - 기능에 따라 애플리케이션을 서비스로 분해

* X-Y는 애플리케이션 능력 / 가용성은 개선이 되지만 복잡해지는 문제는 해결되지 안흔ㄴ다. 따라서 분해가 필요하다.
* 서비스에 따라 X/Z축 확장도 가능



## 2. 모듈성

* 크고 복잡한 애플리케이션을 개발할 때 꼭 필요한 특성
* 한 개인이 전부 다 이해하고 개발할 수 없다. 따라서 여러사람이 이해하고 개발할 수 잇게 여러 모듈로 분해한다.
* 모듈성의 단위로 사용한다. 
* 각 서비스가 함부로 규칙을 어기고 침투하지 못하게 API라는 경계선을 갖고있다
* 시간이 지나도 모듈성을 유지하기 쉽다.
* 독립적으로 배포/확장 할 수 있는 부가적인 장점

## 3. 서비스마다 DB가 따로 있다.

* 서로 다른 디비를 써서 일일히 협의 안하고 본인이 스키마를 변경 가능, 
* 런타임에서 분리가 되어있어서 다른 서비스가 DB락을 획득해 블로킹 하는 일 따위는 없음

## 4. FTGO 마이크로 서비스 아키텍쳐

* 주문 서비스
* 배달 서비스
* 음식점 서비스
* 주방 서비스
* 회계 서비스
* ![image](https://user-images.githubusercontent.com/72075148/134809424-bf8ac0fa-ebbf-474b-8d59-e47909b4a0b1.png)

## 5. SOA

* 서비스 지향 아키텍쳐와 다를 것이 없음 하지만 깊게 들어가면 근본적인 차이점이 있다.

* 서비스 간 통신

  * SOA - SOAP, WS 표준처럼 무거운 프로토콜을 응용한 앤터프라이즈 서비스 버스 중심의 스파트 파이프
  * MSA - REST나 gRPC처럼 가벼운 프로토콜을 응용한 메시지 브로커 또는 서비스 간 통신 중심의 덤 파이프

* 데이터

  * 전역 데이터 모델 및 공유 DB
  * 서비스 개별 데이터 모델 및 DB

  

# 1.5 장단점

## 1. 장점

* 크고 복잡한 애플리케이션을 지속적 전달/배포 가능
* 규모가 작아 관리 쉬움
* 독립적으로 배포/확장 가능
* 팀 운용 쉬움
* 결함 격리가 잘 됨
* 새로운 기술 실험/도입이 쉬움
* 







